---
output:
  html_document: default
  pdf_document: default
---

# Resolu√ß√£o do Protocolo de Pr√°tica ‚Äì Minicurso Introdu√ß√£o ao R
## Autor: Bruno Garcia Piato
___
#### **Se√ß√£o 1: Explorando objetos no R**

__1. Criar e manipular vetores__   

i. Crie um vetor contendo os nomes de alguns integrantes do curso.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
nomes <- c("Bruno", "Daubian", "Stephanie", "Charles", "Max")
```
ii. Delete o 4¬∫ nome.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
nomes <- nomes[-4]
```
iii. Adicione novamente este nome ao final do vetor.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
nomes[5] <- "Charles"
```

__2. Criar e manipular matrizes__  

i. Crie uma matriz 3x3 contendo os valores 1, 2 e 3 na primeira coluna, 4, 5 e 6 na segunda, e 1, 3, 6 na terceira. 
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
matriz1 <- matrix(ncol = 3, nrow = 3, seq(1:9), byrow = FALSE)
```
ii. Crie uma matriz 3x3 contendo valores sequenciais de 1 a 9 distribu√≠dos por linha.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
matriz2 <- matrix(ncol = 3, nrow = 3, seq(1:9), byrow = TRUE)
```
iii. Some as duas matrizes.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
matriz1 + matriz2
```
iv. Multiplique a primeira matriz por 2.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
matriz1 * 2
```

__3. Criar e manipular dataframes__   

i. Crie um dataframe contendo o nome de cada aluno, sua idade, titula√ß√£o acad√™mica e linha principal de pesquisa.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dataframe <- data.frame(Nomes = c("Bruno","Daubian","Stephanie","Charles","Max"), Idade = c(28, 26, 25, 36, 36), Titulo = c("MSc","MSc","MSc","PhD","MSc"), Linha_Pesquisa = c("Filogeografia","Sistematica","Paleontologia","Sistematica","Biologia Molecular"), stringsAsFactors = FALSE) # O argumento stringsAsFactors = FALSE √© importante para que a fun√ß√£o data.frame() n√£o transforme as vari√°veis Nomes e Linha_Pesquisa em fatores, impedindo a entrada posterior de termos contendo mais de uma palavra. Teste este e o pr√≥ximo passos mudando este argumento para TRUE
```
ii. Adicione ao dataframe uma linha contendo as informa√ß√µes do Dr. Willi Hennig aos 42 anos, quando publicou seu trabalho seminal sobre sistem√°tica filogen√©tica.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dataframe[nrow(dataframe)+1,] <- c("Willi Hennig", "42", "PhD", "Sistematica")
```
iii. Adicione uma coluna contendo o sexo de cada observa√ß√£o.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dataframe <- cbind(dataframe, Sexo = c("M", "M", "F", "M", "M", "M"))
```
ou
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dataframe[5] <- c("M", "M", "F", "M", "M", "M")
colnames(dataframe)[5] <- "Sexo"
```
iv. Transforme a coluna rec√©m-adicionada em um fator.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dataframe$Sexo <- factor(dataframe$Sexo)
class(dataframe$Sexo) # Para verificarmos se a mudan√ßa foi mesmo realizada
```
v. Selecione somente os participantes com mais de 30 anos.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dataframe[dataframe$Idade>=30,]
```
ou
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dplyr::filter(dataframe, dataframe$Idade>=30)
```
vi. Selecione somente os participantes que trabalhem com sistem√°tica.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dataframe[dataframe$Linha_Pesquisa=="Sistematica",]
```
vii. Selecione os participantes que tenham mestrado ou doutorado.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dataframe[dataframe$Titulo=="MSc"|dataframe$Titulo=="PhD",]
```
viii. Selecione os participantes que tenham menos que 30 anos e trabalhem com biogeografia.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dataframe[dataframe$Idade<=30 & dataframe$Linha_Pesquisa=="Biogeografia",]
```


__4. Criar listas__   

i. Crie uma lista contendo dois itens: o dataframe completo do exerc√≠cio anterior e um vetor booleano (verdadeiro ou falso) para se o participante consome ou n√£o consome carne.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
lista <- list(Dados = dataframe, Veg = c(F, T, F, F, F, T))
```
ii. Adicione √† lista um vetor fatorial com V para os participantes vivos e M para os mortos.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
lista$Vivo_Morto <- c("V", "V", "V", "V", "V", "M")
```
iii. Adicione os dois vetores rec√©m-criados ao dataframe original.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dataframe <- cbind(dataframe, Veg = lista$Veg, Vivo_Morto = lista$Vivo_Morto)
```
_____
#### Se√ß√£o 2: Importa√ß√£o, explora√ß√£o e prepara√ß√£o de dados
__1. Importar dados__   

i. Importe o arquivo Pokemons.csv para um dataframe no R.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
pokemons <- read.csv("C:/Users/piato/Dropbox/BIOLOGIA/R/MEU CURSO DE R/Material Minicurso IntroduÁ„o ao R/Dados/Pokemons.csv") # Troque o caminho para a pasta em que o arquivo Pokemons.csv se encontra em seu computador. As informa√ß√µes foram baixada do site https://www.kaggle.com/alopez247/pokemon e retiradas do reposit√≥rio de informa√ß√µes https://bulbapedia.bulbagarden.net/wiki/Main_Page 
```

__2. Explorar inicialmente os dados__   

i. Verifique a estrutura, o resumo, o in√≠cio e o final dos dados. Transforme a coluna Name de fator para caracteres
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
str(pokemons)
summary(pokemons)
head(pokemons, 10)
tail(pokemons, 10)
pokemons$Name <- as.character(pokemons$Name)
```
ii. Quais s√£o os Pok√©mons com maior e menor valores de pontos de vida (HP)?
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
max(pokemons$HP)
pokemons[pokemons$HP == max(pokemons$HP),c(2, 6)]
min(pokemons$HP)
pokemons[pokemons$HP == min(pokemons$HP),c(2,6)]
```
iii. Quais s√£o os Pok√©mons com maior e menor ataques (Attack + Sp_Atk)?
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
pokemons2 <- cbind(pokemons, ataque = pokemons$Sp_Atk + pokemons$Attack)
pokemons2[,c(2, 6, 9, 10, 24)]
pokemons2[pokemons2$ataque == max(pokemons2$ataque),c(2, 6, 7, 9, 24)]
pokemons2[pokemons2$ataque == min(pokemons2$ataque),c(2, 6, 7, 9, 24)]
```
iv. Quais s√£o os Pok√©mons com maior e menor defesas (Defense + Sp_Def)?
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
pokemons3 <- cbind(pokemons2, defesa = pokemons$Sp_Def + pokemons$Defense)
pokemons3[,c(2, 6, 9, 10, 24)]
pokemons3[pokemons3$defesa == max(pokemons3$defesa),c(2, 6, 8, 10, 24)]
pokemons3[pokemons3$defesa == min(pokemons3$defesa),c(2, 6, 8, 10, 24)]
```

__3. Preparar dados__   

i. Selecione somente os Pok√©mons lend√°rios, criando um objeto somente com eles.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
lendarios <- pokemons3[pokemons3$isLegendary == "True",]
```
ii. Quais Pok√©mons lend√°rios t√™m maior probabilidade de captura (Catch_Rate/255)?
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
lendarios[lendarios$Catch_Rate == max(lendarios$Catch_Rate), c(2, 6, 9, 10, 22, 24, 25)]
```
ou
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
head(dplyr::arrange(lendarios, desc(Catch_Rate)))
```
iii. Organize os Pok√©mons lend√°rios em ordem alfab√©tica.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dplyr::arrange(lendarios, Name)
```
iv. Organize os Pok√©mons lend√°rios em ordem decrescente da soma de todas as caracter√≠sticas (vari√°vel Total).
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dplyr::arrange(lendarios, desc(Total))
```
v. Amostre aleatoriamente cinco Pok√©mons lend√°rios (antes de implementar a linha para o sorteio, use a fun√ß√£o set.seed(123) para garantir que o resultado de todos seja o mesmo e replic√°vel).
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
set.seed(123)
dplyr::sample_n(lendarios, 5)
```
vi. Agrupe os Pok√©mons lend√°rios de acordo com a gera√ß√£o a que pertencem.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
```
vii. Quantos Pok√©mons lend√°rios h√° de cada tipo prim√°rio?
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
dplyr::count(lendarios, Type_1)
```
Mais fun√ß√µes e usos do pacote _dplyr_ podem ser encontradas no site https://www3.nd.edu/~steve/computing_with_data/24_dplyr/dplyr.html

_____
#### Se√ß√£o 3: Visualiza√ß√£o de dados
__1. Plotar diferentes tipos de gr√°ficos com ggplot2__  

i. Fa√ßa um gr√°fico de dispers√£o dos pontos de ataque (Attack) pelos pontos de defesa (Defense), colorindo de acordo com seu tipo prim√°rio (Type_1).
```{r echo = T, warning = F, results = 'hide', message = F, fig.show = 'asis'}
library(ggplot2)
ggplot(lendarios) + geom_point(aes(x = Defense, y = Attack, color = Type_1), size = 4, alpha = 0.4)
```

ii. Fa√ßa um gr√°fico de caixa (boxplot) dos pontos de vida (HP) de acordo com o tipo prim√°rio (Type_1) do Pok√©mon.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
ggplot(lendarios) + geom_boxplot(aes(y = HP, x = Type_1, fill = Type_1))
```

iii. Fa√ßa um gr√°fico de pizza para as propor√ß√µes dos tipos prim√°rios (Type_1) de Pok√©mons.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
ggplot(pokemons3) + geom_bar(aes(x = Type_1, fill = Type_1)) + coord_polar() + theme_bw() + theme(legend.position="none")
```

ou
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
ggplot(pokemons3) + geom_bar(aes(x = "", y = Type_1, fill = Type_1), stat = "identity") + coord_polar("y", start=0) + theme_bw()
```

iv. Qual √© a melhor evolu√ß√£o do Eevee (Jolteon, Flareon, Vaporeon, Umbreon, Espeon, Leafeon, Glaceon ou Sylveon) com base em seus pontos somados (Total)? Plote quatro gr√°ficos de colunas (_geom_col()_), um para pontos de ataque (Attack), uma para pontos de ataque especial (Sp_Atk), um para pontos de defesa (Defense) e um para defesa especial (Sp_Def), colorindo as barras de acordo com a esp√©cie (_scale_fill_manual(values = c()_).
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
eevee_evo <- pokemons3[pokemons3$Name == "Jolteon" | pokemons3$Name == "Flareon" | pokemons3$Name == "Vaporeon" | pokemons3$Name ==  "Umbreon" | pokemons3$Name ==  "Espeon" | pokemons3$Name ==  "Leafeon" | pokemons3$Name ==  "Glaceon" | pokemons3$Name ==  "Sylveon", ]

dplyr::arrange(eevee_evo, Total)
```
ou
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
ggplot(eevee_evo) + 
  geom_col(aes(y = Total, x = Name, fill = Name), col = "black") + 
  scale_fill_manual(values = c("darkorchid1", "firebrick2", "paleturquoise1", "goldenrod1", "green3", "ghostwhite", "gray12", "deepskyblue4")) + 
  ggtitle(label = "Total") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


ggplot(eevee_evo) + 
  geom_col(aes(y = Attack, x = Name, fill = Name), col = "black") + 
  scale_fill_manual(values = c("darkorchid1", "firebrick2", "paleturquoise1", "goldenrod1", "green3", "ghostwhite", "gray12", "deepskyblue4")) + 
  ggtitle(label = "Ataque") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

ggplot(eevee_evo) + 
  geom_col(aes(y = Sp_Atk, x = Name, fill = Name), col = "black") + 
  scale_fill_manual(values = c("darkorchid1", "firebrick2", "paleturquoise1", "goldenrod1", "green3", "ghostwhite", "gray12", "deepskyblue4")) + 
  ggtitle(label = "Ataque Especial") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

ggplot(eevee_evo) + 
  geom_col(aes(y = Defense, x = Name, fill = Name), col = "black") + 
  scale_fill_manual(values = c("darkorchid1", "firebrick2", "paleturquoise1", "goldenrod1", "green3", "ghostwhite", "gray12", "deepskyblue4")) + 
  ggtitle(label = "Defesa") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


ggplot(eevee_evo) + 
  geom_col(aes(y = Sp_Def, x = Name, fill = Name), col = "black") + 
  scale_fill_manual(values = c("darkorchid1", "firebrick2", "paleturquoise1", "goldenrod1", "green3", "ghostwhite", "gray12", "deepskyblue4")) + 
  ggtitle(label = "Defesa Especial") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

```   

v. Qual √©, entre as evolu√ß√µes do Eevee, o melhor atacante (Attack + Sp_Atk)?
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
ggplot(eevee_evo) + 
  geom_col(aes(y = (Sp_Atk+Attack), x = Name, fill = Name), col = "black") + 
  scale_fill_manual(values = c("darkorchid1", "firebrick2", "paleturquoise1", "goldenrod1", "green3", "ghostwhite", "gray12", "deepskyblue4")) + 
  ggtitle(label = "Ataque + Ataque Especial") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))
```

vi. Qual √©, entre as evolu√ß√µes do Eevee, o melhor atacante (Defense + Sp_Def)?
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
ggplot(eevee_evo) + 
  geom_col(aes(y = (Sp_Def+Defense), x = Name, fill = Name), col = "black") + 
  scale_fill_manual(values = c("darkorchid1", "firebrick2", "paleturquoise1", "goldenrod1", "green3", "ghostwhite", "gray12", "deepskyblue4")) + 
  ggtitle(label = "Defesa + Defesa Especial") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))
```

_____
#### Se√ß√£o 4: An√°lises estat√≠sticas e ecol√≥gicas b√°sicas
__1. Estat√≠sticas b√°sicas__ 

i. H√° correla√ß√£o entre pontos de ataque (Attack) e de defesa (Defense) dos Pok√©mons? Plote o gr√°fico de correla√ß√£o entre eles, ajustando uma reta de regress√£o linear.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
ataqueVSdefesa_lm <- lm(pokemons3$Attack~pokemons3$Defense)
summary(ataqueVSdefesa_lm)
par(mfrow = c(2,2))
plot(ataqueVSdefesa_lm)
par(mfrow = c(1,2))
plot(pokemons3$Attack~pokemons3$Defense)
abline(ataqueVSdefesa_lm, col = "red")
hist(ataqueVSdefesa_lm$residuals)
```

ou
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
library(ggplot2)
ggplot(pokemons3) + geom_point(aes(x = Attack, y = Defense)) + geom_smooth(method = "lm", aes(x = Attack, y = Defense))
```

ii. H√° correla√ß√£o entre pontos de ataque (Attack) e pontos de ataque especial (Sp_Atk) dos Pok√©mons? Plote o gr√°fico de correla√ß√£o entre eles, ajustando uma reta de regress√£o linear.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
ataque_lm <- lm(pokemons3$Attack~pokemons3$Sp_Atk)
summary(ataque_lm)
par(mfrow = c(2,2))
plot(ataque_lm)
par(mfrow = c(1,2))
plot(pokemons3$Attack~pokemons3$Sp_Atk)
abline(ataque_lm, col = "red")
hist(ataque_lm$residuals)
```

ou
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
ggplot(pokemons3) + geom_point(aes(x = Sp_Atk, y = Attack)) + geom_smooth(method = "lm", aes(x = Sp_Atk, y = Attack))
```

iii. H√° diferen√ßa entre os tipos prim√°rios (Type_1) de Pok√©mons quanto a seus pontos de vida, ou os diferentes tipos de Pok√©mons possuem mesma varia√ß√£o de pontos de vida?
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
anova_HP <- aov(HP~Type_1, data = pokemons3)
summary(anova_HP)
TukeyHSD(anova_HP) # Este teste pode ser utilizado para identificar entre quais n√≠veis do fator est√£o as diferen√ßas encontradas na ANOVA
ggplot(pokemons3) + geom_boxplot(aes(y = HP, x = Type_1, fill = Type_1)) # Podemos querer visualizar as diferen√ßas encontradas pelo teste de ANOVA. Lembre-se, entretanto, que em boxplots, o tra√ßo no meio das caixas √© a mediana, enquanto a ANOVA utiliza medidas de m√©dia para testas a hip√≥tese nula (H0) de que n√£o h√° diferen√ßa entre as m√©dias dos n√≠veis de um fator
```

iv. Os pontos de vida dos Pok√©mons se apresentam como em uma distribui√ß√£o normal? Plote um gr√°fico de barras da distribui√ß√£o dos pontos de vida dos Pok√©mons em rela√ß√£o a sua frequ√™ncia.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
shapiro.test(pokemons3$HP)
hist(pokemons3$HP)
```

ou
```{r echo = T, warning = F, results='hide', warning = F, message=FALSE}
ggplot(pokemons3) + geom_histogram(aes(x = HP), alpha = 0.6, fill = "goldenrod3")
```

__2. PCA com dados eco-morfol√≥gicos__ 

i. Carregue o conjunto de dados iris presente no pacote base do R. Veja a estrutura e o resumo dos dados e plote rapidamente um boxplot para cada vari√°vel morfol√≥gica de acordo com as esp√©cies do g√™nero _Iris_ para explorar inicialmente os dados. Que insights podemos tirar dessa visualiza√ß√£o preliminar dos dados?
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
data(iris)
summary(iris)
str(iris)
par(mfrow = c(2,2)) # Podemos usar a fun√ß√£o par() para definir propriedades do dispositivo gr√°fico. Neste caso estamos definindo, no argumento mfrow, um vetor contendo o n√∫mero de linhas e colunas, respectivamente que o dispositivo gr√°fico deve ter. Para resetar o dospositivo podemos usar a fun√ß√£o dev.off()
boxplot(iris$Sepal.Length~iris$Species)
boxplot(iris$Sepal.Width~iris$Species)
boxplot(iris$Petal.Length~iris$Species)
boxplot(iris$Petal.Width~iris$Species)
```

ii. Realize uma An√°lise de Componentes Principais (PCA) escalonada utilizando as quatro vari√°veis morfol√≥gicas e plote um gr√°fico do resultado dos dois principais componentes (PC1 e PC2), colorindo por esp√©cie.
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
PCAiris <- princomp(iris[,-5], cor = T)
library(ggplot2)
ggplot(as.data.frame(PCAiris$scores)) + geom_point(aes(x = Comp.1, y = Comp.2, col = iris$Species)) + stat_ellipse(aes(x = Comp.1, y = Comp.2, col = iris$Species))
```


__3. PCA com dados gen√©ticos__ 

i. Algo
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
```

__4. Diversidade Filogen√©tica__ 

i. Algo
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
```

_____
#### Se√ß√£o 5: An√°lises filogen√©ticas b√°sicas
__1. An√°lise de m√°xima parcim√¥nia__ 

i. Alguma coisa
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
```
__2. An√°lise de m√°xima verossimilhan√ßa__ 

i. Algo
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
```

_____
#### Se√ß√£o 6: Breves manipula√ß√µes de mapas
__1. Importando rasters__

i. Algo
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
```

__2. Criando e cortando stacks__

i. Algo
```{r echo = T, warning = F, results='hide', fig.show = 'asis'}
```